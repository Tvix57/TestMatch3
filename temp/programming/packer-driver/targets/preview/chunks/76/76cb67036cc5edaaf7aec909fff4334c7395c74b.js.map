{"version":3,"sources":["file:///F:/git/TestMatch3/assets/Scripts/Session/GameoverListener.ts"],"names":["GameoverListener","AppRoot","AnsverDialogComponent","DialogFactory","LocationType","constructor","_gameLogic","_sceneManager","_dialogFactory","ResolveField","AddHandler","NewGame","name","EndGame","info","getInstance","ResolveGameContext","FinishGame","showEndDialog","CreateDialog","then","dialog","getComponent","SetHandler","isAccept","Transfer","StartScene","ScoreScene"],"mappings":";;;2FAeaA,gB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAfJC,MAAAA,O,iBAAAA,O;;AACAC,MAAAA,qB,iBAAAA,qB;;AACAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;kCAYIJ,gB,GAAN,MAAMA,gBAAN,CACP;AAEIK,QAAAA,WAAW,CACCC,UADD,EAECC,aAFD,EAGT;AAAA,eAJMC,cAIN,GAJuB;AAAA;AAAA,8CAAkB,0BAAlB,CAIvB;AAAA,eAFUF,UAEV,GAFUA,UAEV;AAAA,eADUC,aACV,GADUA,aACV;;AACE,eAAKD,UAAL,CAAgBG,YAAhB,GAA+BC,UAA/B,CAA0C,IAA1C;AACH;;AAEDC,QAAAA,OAAO,CAACC,IAAD,EAAqB,CAAE;;AAE9BC,QAAAA,OAAO,CAACC,IAAD,EAA4B;AAC/B;AAAA;AAAA,kCAAQC,WAAR,CAAoBC,kBAApB,GAAyCC,UAAzC;AACA,eAAKC,aAAL;AACH;;AAEOA,QAAAA,aAAa,GAAG;AACpB,eAAKV,cAAL,CAAoBW,YAApB,GAAmCC,IAAnC,CAAyCC,MAAD,IAAY;AAChDA,YAAAA,MAAM,CAACC,YAAP;AAAA;AAAA,gEAA4CC,UAA5C,CAAwDC,QAAD,IAAsB;AACzE,kBAAIA,QAAJ,EAAc;AACV,qBAAKjB,aAAL,CAAmBkB,QAAnB,CAA4B;AAAA;AAAA,kDAAaC,UAAzC;AACH,eAFD,MAEO;AACH,qBAAKnB,aAAL,CAAmBkB,QAAnB,CAA4B;AAAA;AAAA,kDAAaE,UAAzC;AACH;AACJ,aAND;AAOH,WARD;AASH;;AA1BL,O","sourcesContent":["import { AppRoot } from \"../Application/AppRoot\";\r\nimport { AnsverDialogComponent } from \"../Dialog/AnsverDialogComponent\";\r\nimport { DialogFactory } from \"../Dialog/DialogFactory\";\r\nimport { LocationType } from \"../Enums/LocationType\";\r\nimport { IFieldHandler } from \"../Logic/Field\";\r\nimport { GameStatsInfo } from \"../Logic/GameStatsInfo\";\r\nimport { ApplicationState } from \"../Save/State\";\r\nimport { ISceneManager } from \"../Scene/ISceneManager\";\r\nimport { GameLogic } from \"./GameLogic\";\r\n\r\nexport type GameoverConfig = {\r\n    lifeExtendBy:number,\r\n    welfareIncreaseBy:number\r\n}\r\n\r\nexport class GameoverListener implements IFieldHandler\r\n{\r\n    private _dialogFactory = new DialogFactory(\"Prefabs/Dialog/EndDialog\");\r\n    constructor(\r\n        private _gameLogic:GameLogic,\r\n        private _sceneManager:ISceneManager\r\n    ) {\r\n        this._gameLogic.ResolveField().AddHandler(this)\r\n    }\r\n\r\n    NewGame(name: string): void {}\r\n\r\n    EndGame(info: GameStatsInfo): void {\r\n        AppRoot.getInstance.ResolveGameContext().FinishGame()\r\n        this.showEndDialog()\r\n    }\r\n\r\n    private showEndDialog() {\r\n        this._dialogFactory.CreateDialog().then((dialog) => {\r\n            dialog.getComponent(AnsverDialogComponent)!.SetHandler((isAccept:boolean) => {\r\n                if (isAccept) { \r\n                    this._sceneManager.Transfer(LocationType.StartScene)\r\n                } else {\r\n                    this._sceneManager.Transfer(LocationType.ScoreScene)\r\n                }\r\n            })\r\n        })\r\n    }\r\n}\r\n"]}