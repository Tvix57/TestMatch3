{"version":3,"sources":["file:///F:/git/TestMatch3/assets/Scripts/Session/GameContext.ts"],"names":["GameContext","GameLogic","GameoverListener","GameSaveListener","SessionDeviceListener","constructor","sceneManager","device","_logic","_state","_gameoverListener","_saveListener","_sessionDeviceListener","isGameActive","CreateGame","library","timer","saveDisp","state","gameState","_adsContext","_store","_tutorialContext","_statisticsAgregator","FinishGame","isFinished","ClearGame","ManualSave","Finish","RemoveHandler","RemoveAll","IsGameActive","ResolveGame","ResolveState"],"mappings":";;;oGAmBaA,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAVJC,MAAAA,S,iBAAAA,S;;AAEAC,MAAAA,gB,iBAAAA,gB;;AAGAC,MAAAA,gB,iBAAAA,gB;;AACAC,MAAAA,qB,iBAAAA,qB;;;;;;AAfT;AACA;AACA;AACA;AACA;AACA;;;6BAcaJ,W,GAAN,MAAMA,WAAN,CAAkB;AAQrBK,QAAAA,WAAW,CACCC,YADD,EAECC,MAFD,EAGT;AAAA,eAVMC,MAUN,GAViC,IAUjC;AAAA,eATMC,MASN;AAAA,eARMC,iBAQN,GARmD,IAQnD;AAAA,eAPMC,aAON;AAAA,eANMC,sBAMN;AAAA,eALMC,YAKN,GALqB,KAKrB;AAAA,eAFUP,YAEV,GAFUA,YAEV;AAAA,eADUC,MACV,GADUA,MACV;AAAE;;AAEJO,QAAAA,UAAU,CAACC,OAAD,EACCC,KADD,EAECC,QAFD,EAGCC,KAHD,EAIT;AACG,eAAKL,YAAL,GAAoB,IAApB;AACA,eAAKJ,MAAL,GAAcS,KAAK,CAACC,SAApB;AACA,eAAKX,MAAL,GAAc;AAAA;AAAA,sCAAcO,OAAd,EAAuBC,KAAvB,EAA8B,KAAKP,MAAnC,CAAd;AAEA,eAAKC,iBAAL,GAAyB;AAAA;AAAA,oDAAqB,KAAKF,MAA1B,CAAzB;AAEA,eAAKG,aAAL,GAAqB;AAAA;AAAA,oDAAqBM,QAArB,EAA+B,KAAKT,MAApC,EAA4C,KAAKY,WAAjD,EAA8D,KAAKC,MAAnE,EAA0E,KAAKC,gBAA/E,EAAiG,KAAKf,MAAtG,EAA8G,KAAKgB,oBAAnH,EAAyIL,KAAzI,CAArB;AAEA,eAAKN,sBAAL,GAA8B;AAAA;AAAA,8DAA0B,KAAKL,MAA/B,EAAsC,KAAKC,MAA3C,CAA9B;AACH;;AAEDgB,QAAAA,UAAU,GAAG;AACT,eAAKf,MAAL,CAAYgB,UAAZ,GAAyB,IAAzB;AACH;;AACDC,QAAAA,SAAS,GAAE;AAAA;;AACP,eAAKf,aAAL,CAAmBgB,UAAnB;;AACA,+BAAKnB,MAAL,kCAAaoB,MAAb;AACA,eAAKpB,MAAL,GAAc,IAAd;AACA,eAAKE,iBAAL,GAAyB,IAAzB;AACA,eAAKG,YAAL,GAAoB,KAApB;;AACA,eAAKD,sBAAL,CAA4BiB,aAA5B;;AACA,eAAKlB,aAAL,CAAmBkB,aAAnB;;AACA,eAAKvB,YAAL,CAAkBwB,SAAlB;AACH;;AAEDC,QAAAA,YAAY,GAAE;AACV,iBAAO,KAAKlB,YAAZ;AACH;;AAEDmB,QAAAA,WAAW,GAAG;AACV,iBAAO,KAAKxB,MAAZ;AACH;;AACDyB,QAAAA,YAAY,GAAG;AACX,iBAAO,KAAKxB,MAAZ;AACH;;AApDoB,O","sourcesContent":["/**\r\n *\r\n * GameContext.ts\r\n * db://assets/Scripts/Game/GameContext.ts\r\n *\r\n */\r\n\r\n\r\nimport { Library } from \"../Settings/Library\";\r\nimport { GameLogic } from \"./GameLogic\";\r\nimport { GameState } from \"./GameState\";\r\nimport { GameoverListener } from \"./GameoverListener\";\r\nimport { ApplicationState } from \"../Save/State\";\r\nimport { SaveDispatcher } from \"../Save/SaveDispatcher\";\r\nimport { GameSaveListener } from \"./GameSaveListener\";\r\nimport { SessionDeviceListener } from \"./SessionDeviceListener\";\r\nimport { ISceneManager } from \"../Scene/ISceneManager\";\r\nimport { AppDevice } from \"../Application/AppDevice\";\r\n\r\nexport class GameContext {\r\n    private _logic: GameLogic | null = null;\r\n    private _state!: GameState;\r\n    private _gameoverListener: GameoverListener | null = null;\r\n    private _saveListener!: GameSaveListener;\r\n    private _sessionDeviceListener!:SessionDeviceListener\r\n    private isGameActive = false\r\n\r\n    constructor(\r\n        private sceneManager: ISceneManager,\r\n        private device: AppDevice,\r\n    ) {}\r\n\r\n    CreateGame(library: Library,\r\n               timer: IAppTimer,\r\n               saveDisp: SaveDispatcher,\r\n               state: ApplicationState\r\n    ){\r\n        this.isGameActive = true\r\n        this._state = state.gameState!;\r\n        this._logic = new GameLogic(library, timer, this._state);\r\n        \r\n        this._gameoverListener = new GameoverListener(this._logic);\r\n\r\n        this._saveListener = new GameSaveListener(saveDisp, this._logic, this._adsContext, this._store,this._tutorialContext, this.device, this._statisticsAgregator, state);\r\n       \r\n        this._sessionDeviceListener = new SessionDeviceListener(this.device,this._logic)\r\n    }\r\n\r\n    FinishGame() {\r\n        this._state.isFinished = true\r\n    }\r\n    ClearGame(){\r\n        this._saveListener.ManualSave()\r\n        this._logic?.Finish();\r\n        this._logic = null;\r\n        this._gameoverListener = null;\r\n        this.isGameActive = false;\r\n        this._sessionDeviceListener.RemoveHandler()\r\n        this._saveListener.RemoveHandler()\r\n        this.sceneManager.RemoveAll()\r\n    }\r\n\r\n    IsGameActive(){ \r\n        return this.isGameActive \r\n    }\r\n\r\n    ResolveGame() {\r\n        return this._logic!;\r\n    }\r\n    ResolveState() {\r\n        return this._state;\r\n    }\r\n}\r\n"]}