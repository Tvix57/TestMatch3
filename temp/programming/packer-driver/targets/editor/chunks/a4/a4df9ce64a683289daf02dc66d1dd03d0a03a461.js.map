{"version":3,"sources":["file:///F:/git/TestMatch3/assets/Scripts/Session/GameContext.ts"],"names":["GameContext","GameLogic","SessionDeviceListener","constructor","sceneManager","device","_logic","_state","_gameoverListener","_saveListener","_sessionDeviceListener","isGameActive","CreateGame","timer","saveDisp","state","gameState","FinishGame","isFinished","ClearGame","ManualSave","Finish","RemoveHandler","RemoveAll","IsGameActive","ResolveGame","ResolveState"],"mappings":";;;gEAWaA,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAXJC,MAAAA,S,iBAAAA,S;;AAMAC,MAAAA,qB,iBAAAA,qB;;;;;;;6BAKIF,W,GAAN,MAAMA,WAAN,CAAkB;AAQrBG,QAAAA,WAAW,CACCC,YADD,EAECC,MAFD,EAGT;AAAA,eAVMC,MAUN,GAViC,IAUjC;AAAA,eATMC,MASN;AAAA,eARMC,iBAQN,GARmD,IAQnD;AAAA,eAPMC,aAON;AAAA,eANMC,sBAMN;AAAA,eALMC,YAKN,GALqB,KAKrB;AAAA,eAFUP,YAEV,GAFUA,YAEV;AAAA,eADUC,MACV,GADUA,MACV;AAAE;;AAEJO,QAAAA,UAAU,CAACC,KAAD,EACCC,QADD,EAECC,KAFD,EAGT;AACG,eAAKJ,YAAL,GAAoB,IAApB;AACA,eAAKJ,MAAL,GAAcQ,KAAK,CAACC,SAApB;AACA,eAAKV,MAAL,GAAc;AAAA;AAAA,sCAAcO,KAAd,EAAqB,KAAKN,MAA1B,CAAd,CAHH,CAKG;AAEA;;AAEA,eAAKG,sBAAL,GAA8B;AAAA;AAAA,8DAA0B,KAAKL,MAA/B,EAAsC,KAAKC,MAA3C,CAA9B;AACH;;AAEDW,QAAAA,UAAU,GAAG;AACT,eAAKV,MAAL,CAAYW,UAAZ,GAAyB,IAAzB;AACH;;AACDC,QAAAA,SAAS,GAAE;AAAA;;AACP,eAAKV,aAAL,CAAmBW,UAAnB;;AACA,+BAAKd,MAAL,kCAAae,MAAb;AACA,eAAKf,MAAL,GAAc,IAAd;AACA,eAAKE,iBAAL,GAAyB,IAAzB;AACA,eAAKG,YAAL,GAAoB,KAApB;;AACA,eAAKD,sBAAL,CAA4BY,aAA5B;;AACA,eAAKb,aAAL,CAAmBa,aAAnB;;AACA,eAAKlB,YAAL,CAAkBmB,SAAlB;AACH;;AAEDC,QAAAA,YAAY,GAAE;AACV,iBAAO,KAAKb,YAAZ;AACH;;AAEDc,QAAAA,WAAW,GAAG;AACV,iBAAO,KAAKnB,MAAZ;AACH;;AACDoB,QAAAA,YAAY,GAAG;AACX,iBAAO,KAAKnB,MAAZ;AACH;;AAnDoB,O","sourcesContent":["import { GameLogic } from \"./GameLogic\";\r\nimport { GameState } from \"./GameState\";\r\nimport { GameoverListener } from \"./GameoverListener\";\r\nimport { ApplicationState } from \"../Save/State\";\r\nimport { SaveDispatcher } from \"../Save/SaveDispatcher\";\r\nimport { GameSaveListener } from \"./GameSaveListener\";\r\nimport { SessionDeviceListener } from \"./SessionDeviceListener\";\r\nimport { ISceneManager } from \"../Scene/ISceneManager\";\r\nimport { AppDevice } from \"../Application/AppDevice\";\r\nimport { IAppTimer } from \"../Application/IAppTimer\";\r\n\r\nexport class GameContext {\r\n    private _logic: GameLogic | null = null;\r\n    private _state!: GameState;\r\n    private _gameoverListener: GameoverListener | null = null;\r\n    private _saveListener!: GameSaveListener;\r\n    private _sessionDeviceListener!:SessionDeviceListener\r\n    private isGameActive = false\r\n\r\n    constructor(\r\n        private sceneManager: ISceneManager,\r\n        private device: AppDevice,\r\n    ) {}\r\n\r\n    CreateGame(timer: IAppTimer,\r\n               saveDisp: SaveDispatcher,\r\n               state: ApplicationState\r\n    ){\r\n        this.isGameActive = true\r\n        this._state = state.gameState!;\r\n        this._logic = new GameLogic(timer, this._state);\r\n        \r\n        // this._gameoverListener = new GameoverListener(this._logic);\r\n\r\n        // this._saveListener = new GameSaveListener(saveDisp, this._logic, this.device, state);\r\n       \r\n        this._sessionDeviceListener = new SessionDeviceListener(this.device,this._logic)\r\n    }\r\n\r\n    FinishGame() {\r\n        this._state.isFinished = true\r\n    }\r\n    ClearGame(){\r\n        this._saveListener.ManualSave()\r\n        this._logic?.Finish();\r\n        this._logic = null;\r\n        this._gameoverListener = null;\r\n        this.isGameActive = false;\r\n        this._sessionDeviceListener.RemoveHandler()\r\n        this._saveListener.RemoveHandler()\r\n        this.sceneManager.RemoveAll()\r\n    }\r\n\r\n    IsGameActive(){ \r\n        return this.isGameActive \r\n    }\r\n\r\n    ResolveGame() {\r\n        return this._logic!;\r\n    }\r\n    ResolveState() {\r\n        return this._state;\r\n    }\r\n}\r\n"]}