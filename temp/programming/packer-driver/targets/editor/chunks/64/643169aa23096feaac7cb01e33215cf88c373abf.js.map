{"version":3,"sources":["file:///F:/git/TestMatch3/assets/Scripts/Session/SessionDeviceListener.ts"],"names":["SessionDeviceListener","ManagerTypes","constructor","device","logic","AddHandler","RemoveHandler","OnPauseApplication","UpdateSchedulers","OnResumeApplication","count","_dailyBonusTimer","ResolveScheduler","ScheduleDMS","confirm","ResolveDepositsContext","GetAll","filter","value","IsTimeComming","length","ResolveBusiness","manager","NONE","CASUAL"],"mappings":";;;4CAIaA,qB;;;;;;;;;;;;;;;;;;;;;;;;;;AAHJC,MAAAA,Y,iBAAAA,Y;;;;;;;uCAGID,qB,GAAN,MAAMA,qBAAN,CACP;AACIE,QAAAA,WAAW,CAASC,MAAT,EAAmCC,KAAnC,EAAmD;AAAA,eAA1CD,MAA0C,GAA1CA,MAA0C;AAAA,eAAhBC,KAAgB,GAAhBA,KAAgB;AAC1DD,UAAAA,MAAM,CAACE,UAAP,CAAkB,IAAlB;AACH;;AACDC,QAAAA,aAAa,GAAE;AACX,eAAKH,MAAL,CAAYG,aAAZ,CAA0B,IAA1B;AACH;;AACDC,QAAAA,kBAAkB,GAAS;AACvB,eAAKC,gBAAL;AACH;;AACDC,QAAAA,mBAAmB,GAAS,CAE3B;;AAEOD,QAAAA,gBAAgB,GAAE;AACtB,cAAIE,KAAK,GAAG,CAAZ;AACA,cAAIC,gBAAgB,GAAG,IAAvB;;AAEA,cAAGA,gBAAH,EAAoB;AAChB,iBAAKR,MAAL,CAAYS,gBAAZ,GAA+BC,WAA/B,CAA2C,YAA3C,EACwB,wBADxB,EAEwB,uCAFxB,EAGwB,CAHxB,EAG2B,CAH3B,EAG8B,CAH9B;AAIAH,YAAAA,KAAK;AACR;;AACD,cAAGA,KAAK,GAAG,CAAX,EACA;AAAA;;AACI,kBAAMI,OAAO,GAAG,KAAKV,KAAL,CAAWW,sBAAX,GAAoCC,MAApC,GAA6CC,MAA7C,CAAqDC,KAAD,IAAS,KAAKd,KAAL,CAAWW,sBAAX,GAAoCI,aAApC,CAAkDD,KAAlD,CAA7D,CAAhB;;AACA,gBAAG,oBAACJ,OAAO,CAACM,MAAT,8BAAmB,CAAnB,IAAwB,CAA3B,EAA6B;AACzB,mBAAKjB,MAAL,CAAYS,gBAAZ,GAA+BC,WAA/B,CAA2C,gBAA3C,EACwB,wBADxB,EAEwB,uCAFxB,EAGwB,EAHxB,EAG4B,EAH5B,EAGgC,CAHhC;AAIAH,cAAAA,KAAK;AACR;AACJ;;AACD,cAAGA,KAAK,GAAG,CAAX,EACA;AAAA;;AACI,kBAAMO,MAAM,GAAG,KAAKb,KAAL,CAAWiB,eAAX,GAA6BL,MAA7B,GAAsCC,MAAtC,CAA8CC,KAAD,IAAUA,KAAK,CAACI,OAAN,IAAiB;AAAA;AAAA,8CAAaC,IAA/B,IAAyCL,KAAK,CAACI,OAAN,IAAiB;AAAA;AAAA,8CAAaE,MAA7H,CAAf;;AACA,gBAAG,mBAACP,MAAD,oBAACA,MAAM,CAAEG,MAAT,6BAAmB,CAAnB,IAAwB,CAA3B,EACA;AACI,mBAAKjB,MAAL,CAAYS,gBAAZ,GAA+BC,WAA/B,CAA2C,iBAA3C,EACwB,wBADxB,EAEwB,uCAFxB,EAGwB,EAHxB,EAG2B,EAH3B,EAG8B,CAH9B;AAIAH,cAAAA,KAAK;AACR;AACJ;;AACD,cAAGA,KAAK,GAAG,CAAX,EAAc;AACV,iBAAKP,MAAL,CAAYS,gBAAZ,GAA+BC,WAA/B,CAA2C,UAA3C,EAC4B,wBAD5B,EAE4B,oCAF5B,EAG4B,CAH5B,EAG8B,CAH9B,EAGgC,CAHhC;AAIAH,YAAAA,KAAK;AACR;AACJ;;AAvDL,O","sourcesContent":["import { AppDevice, IApplicationHandler } from \"../Application/AppDevice\";\r\nimport { ManagerTypes } from \"../BusinessScene/ManagerTypes\";\r\nimport { GameLogic } from \"../Game/GameLogic\";\r\n\r\nexport class SessionDeviceListener implements IApplicationHandler\r\n{\r\n    constructor(private device:AppDevice, private logic:GameLogic){\r\n        device.AddHandler(this)\r\n    }\r\n    RemoveHandler(){\r\n        this.device.RemoveHandler(this)\r\n    }\r\n    OnPauseApplication(): void {\r\n        this.UpdateSchedulers()\r\n    }\r\n    OnResumeApplication(): void {\r\n        \r\n    }\r\n\r\n    private UpdateSchedulers(){\r\n        let count = 0;\r\n        let _dailyBonusTimer = true\r\n\r\n        if(_dailyBonusTimer){\r\n            this.device.ResolveScheduler().ScheduleDMS(\"DailyBonus\",\r\n                                    \"PushNotification.Title\",\r\n                                    \"PushNotification.RewardedNotification\",\r\n                                    9, 0, 0);\r\n            count++;\r\n        }\r\n        if(count < 2)\r\n        {\r\n            const confirm = this.logic.ResolveDepositsContext().GetAll().filter((value)=>this.logic.ResolveDepositsContext().IsTimeComming(value))            \r\n            if((confirm.length ?? 0) > 0){\r\n                this.device.ResolveScheduler().ScheduleDMS(\"DepositContext\",\r\n                                        \"PushNotification.Title\",\r\n                                        \"PushNotification.LongAwayNotification\",\r\n                                        12, 30, 0);\r\n                count++;\r\n            }\r\n        }\r\n        if(count < 2)\r\n        {\r\n            const filter = this.logic.ResolveBusiness().GetAll().filter((value)=>(value.manager == ManagerTypes.NONE) || (value.manager == ManagerTypes.CASUAL))\r\n            if((filter?.length ?? 0) > 0)\r\n            {\r\n                this.device.ResolveScheduler().ScheduleDMS(\"BusinessContext\",\r\n                                        \"PushNotification.Title\",\r\n                                        \"PushNotification.LongAwayNotification\",\r\n                                        12,30,0);\r\n                count ++;\r\n            }\r\n        }\r\n        if(count < 2) {\r\n            this.device.ResolveScheduler().ScheduleDMS(\"Reminder\",\r\n                                        \"PushNotification.Title\",\r\n                                        \"PushNotification.DailyNotification\",\r\n                                        9,0,0);\r\n            count ++;\r\n        }\r\n    }\r\n}"]}