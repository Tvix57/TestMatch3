{"version":3,"sources":["file:///F:/git/TestMatch3/assets/Scripts/Logic/Loop.ts"],"names":["Loop","AbstractDispatcher","TimeSpeed","constructor","timer","_speedType","_pauseCount","_btnPause","AddHandler","Play","OnActivate","OnDeactivate","Tick","GetTimeSpeed","_dispatcher","Post","arg","OnDayChange","Tick10","SpeedUp","SetBtnPause","isPause","h","OnTimeSpeedChange","SetPause","SetSpeedUp","isSpeedup","GetPause","GetBtnPause","Pause"],"mappings":";;;kDAuBaA,I;;;;;;;;;;;;;;;;;;;;;;AAfJC,MAAAA,kB,iBAAAA,kB;;;;;;AART;AACA;AACA;AACA;AACA;AACA;;;2BAKYC,S,0BAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;eAAAA,S;;;sBAaCF,I,GAAN,MAAMA,IAAN;AAAA;AAAA,oDACP;AAKIG,QAAAA,WAAW,CAACC,KAAD,EAAiB;AACxB;AADwB,eAJpBC,UAIoB;AAAA,eAHpBC,WAGoB;AAAA,eAFpBC,SAEoB;AAExBH,UAAAA,KAAK,CAACI,UAAN,CAAiB,IAAjB;AACA,eAAKH,UAAL,GAAkBH,SAAS,CAACO,IAA5B;AACA,eAAKH,WAAL,GAAmB,KAAnB;AACA,eAAKC,SAAL,GAAiB,KAAjB;AACH;;AAEDG,QAAAA,UAAU,GAAS;AACf,gBAAM,oCAAN;AACH;;AACDC,QAAAA,YAAY,GAAS;AACjB;AACA,gBAAM,oCAAN;AACH;;AACDC,QAAAA,IAAI,GAAS;AACT,cAAG,KAAKC,YAAL,OAAwBX,SAAS,CAACO,IAArC,EAA0C;AACtC,iBAAKK,WAAL,CAAiBC,IAAjB,CAAuBC,GAAD,IAAOA,GAAG,CAACC,WAAX,oBAAOD,GAAG,CAACC,WAAJ,EAA7B;AACH;AACJ;;AACDC,QAAAA,MAAM,GAAS;AACX,cAAG,KAAKL,YAAL,OAAwBX,SAAS,CAACiB,OAArC,EAA6C;AACzC,iBAAKL,WAAL,CAAiBC,IAAjB,CAAuBC,GAAD,IAAOA,GAAG,CAACC,WAAX,oBAAOD,GAAG,CAACC,WAAJ,EAA7B;AACH;AACJ;;AAEDG,QAAAA,WAAW,CAACC,OAAD,EAAiB;AACxB,eAAKd,SAAL,GAAiBc,OAAjB;;AACA,eAAKP,WAAL,CAAiBC,IAAjB,CAAuBO,CAAD,IAAkBA,CAAC,CAACC,iBAApB,oBAAkBD,CAAC,CAACC,iBAAF,CAAsB,KAAKV,YAAL,EAAtB,CAAxC;AACH;;AAEDW,QAAAA,QAAQ,CAACH,OAAD,EAAiB;AACrB,eAAKf,WAAL,GAAmBe,OAAnB;;AACA,eAAKP,WAAL,CAAiBC,IAAjB,CAAuBO,CAAD,IAAkBA,CAAC,CAACC,iBAApB,oBAAkBD,CAAC,CAACC,iBAAF,CAAsB,KAAKV,YAAL,EAAtB,CAAxC;AACH;;AACDY,QAAAA,UAAU,CAACC,SAAD,EAAmB;AACzB,eAAKrB,UAAL,GAAkBqB,SAAS,GAAGxB,SAAS,CAACiB,OAAb,GAAuBjB,SAAS,CAACO,IAA5D;;AACA,eAAKK,WAAL,CAAiBC,IAAjB,CAAuBO,CAAD,IAAkBA,CAAC,CAACC,iBAApB,oBAAkBD,CAAC,CAACC,iBAAF,CAAsB,KAAKV,YAAL,EAAtB,CAAxC;AACH;;AAEDc,QAAAA,QAAQ,GAAG;AAAE,iBAAO,KAAKrB,WAAZ;AAAyB;;AACtCsB,QAAAA,WAAW,GAAG;AAAE,iBAAO,KAAKrB,SAAZ;AAAuB;;AAEvCM,QAAAA,YAAY,GACZ;AACI,cAAG,KAAKP,WAAL,IAAoB,KAAKC,SAA5B,EAAuC,OAAOL,SAAS,CAAC2B,KAAjB;AACvC,iBAAO,KAAKxB,UAAZ;AACH;;AApDL,O","sourcesContent":["/**\r\n * \r\n * Loop.ts\r\n * db://assets/Scripts/Game/Loop.ts\r\n *\r\n */\r\n\r\nimport { IAppTimer, IAppTimerHandler } from \"../Application/IAppTimer\"\r\nimport { AbstractDispatcher } from \"../Utils/Dispatcher\"\r\n\r\nexport enum TimeSpeed\r\n{\r\n    Pause,\r\n    Play,\r\n    SpeedUp\r\n}\r\n\r\nexport interface ILoopHandler\r\n{\r\n    OnDayChange?() : void\r\n    OnTimeSpeedChange?(newValue:TimeSpeed):void\r\n}\r\n\r\nexport class Loop extends AbstractDispatcher<ILoopHandler> implements IAppTimerHandler\r\n{\r\n    private _speedType:TimeSpeed\r\n    private _pauseCount:boolean\r\n    private _btnPause:boolean\r\n    \r\n    constructor(timer:IAppTimer){\r\n        super()\r\n        timer.AddHandler(this)\r\n        this._speedType = TimeSpeed.Play\r\n        this._pauseCount = false\r\n        this._btnPause = false\r\n    }\r\n\r\n    OnActivate(): void {\r\n        throw \"FIXME: Loop add mechanic if needed\"\r\n    }\r\n    OnDeactivate(): void {\r\n        //FIXME:add mechanic if needed\r\n        throw \"FIXME: Loop add mechanic if needed\"\r\n    }\r\n    Tick(): void {\r\n        if(this.GetTimeSpeed() === TimeSpeed.Play){\r\n            this._dispatcher.Post((arg)=>arg.OnDayChange?.())\r\n        }\r\n    }\r\n    Tick10(): void {\r\n        if(this.GetTimeSpeed() === TimeSpeed.SpeedUp){\r\n            this._dispatcher.Post((arg)=>arg.OnDayChange?.())\r\n        }\r\n    }\r\n\r\n    SetBtnPause(isPause:boolean){\r\n        this._btnPause = isPause\r\n        this._dispatcher.Post((h:ILoopHandler)=>h.OnTimeSpeedChange?.(this.GetTimeSpeed()))\r\n    }\r\n\r\n    SetPause(isPause:boolean){\r\n        this._pauseCount = isPause\r\n        this._dispatcher.Post((h:ILoopHandler)=>h.OnTimeSpeedChange?.(this.GetTimeSpeed()))\r\n    }\r\n    SetSpeedUp(isSpeedup:boolean){\r\n        this._speedType = isSpeedup ? TimeSpeed.SpeedUp : TimeSpeed.Play\r\n        this._dispatcher.Post((h:ILoopHandler)=>h.OnTimeSpeedChange?.(this.GetTimeSpeed()))\r\n    }\r\n\r\n    GetPause() { return this._pauseCount }\r\n    GetBtnPause() { return this._btnPause }\r\n    \r\n    GetTimeSpeed():TimeSpeed\r\n    {\r\n        if(this._pauseCount || this._btnPause) return TimeSpeed.Pause\r\n        return this._speedType\r\n    }\r\n    \r\n}"]}