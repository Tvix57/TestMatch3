{"version":3,"sources":["file:///F:/git/TestMatch3/assets/Scripts/Save/State.ts"],"names":["ApplicationState","AdsState","GameState","StoreState","IState","SettingsState","StatisticState","AppsflyerState","OfferState","constructor","version","lang","gameState","adsState","storeState","offerState","settings","statistic","appsflyerState","firstLaunch","firstLaunchTime","hardmodeDeadline","hardSave","isRated","isFirstLaunch","Date","HasGame","IsGameFinished","isFinished","HasHardsave","undefined","Save","JSON","stringify","Load","input","obj","parse"],"mappings":"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","sourcesContent":["/**\r\n * \r\n * State.ts\r\n * db://assets/Scripts/Save/State.ts\r\n *\r\n */\r\n\r\nimport { AdsState } from \"../Ads/AdsState\";\r\nimport { GameState } from \"../Game/GameState\";\r\nimport { StoreState } from \"../Store/StoreState\";\r\nimport { IState } from \"./SaveInterfaces\";\r\nimport { SettingsState } from \"../Settings/SettingsState\";\r\nimport { StatisticState } from \"../Statistic/StatisticState\";\r\nimport { AppsflyerState } from \"../Statistic/AppsflyerState\";\r\nimport { OfferState } from \"../Offers/OfferState\";\r\n\r\nexport class ApplicationState extends IState\r\n{\r\n    gameState?:GameState\r\n    adsState!:AdsState\r\n    storeState!:StoreState\r\n    \r\n    settings!: SettingsState\r\n    statistic!: StatisticState\r\n    appsflyerState!:AppsflyerState\r\n    isFirstLaunch:boolean\r\n    firstLaunchTime:Date\r\n    hardmodeDeadline:Date\r\n    hardSave?:GameState\r\n    isRated:boolean\r\n    version:number\r\n\r\n    constructor(\r\n        version:number,\r\n        lang:string,\r\n        gameState?:GameState,\r\n        adsState?:AdsState,\r\n        storeState?:StoreState,\r\n        offerState?:OfferState,\r\n        settings?:SettingsState,\r\n        statistic?:StatisticState,\r\n        appsflyerState?:AppsflyerState,\r\n        firstLaunch?:boolean,\r\n        firstLaunchTime?:Date,\r\n        hardmodeDeadline?:Date,\r\n        hardSave?:GameState,\r\n        isRated?:boolean\r\n    ){\r\n        super();\r\n        this.version = version\r\n        this.isFirstLaunch = firstLaunch ?? true\r\n        this.firstLaunchTime = firstLaunchTime ?? new Date();\r\n        this.gameState = gameState \r\n        this.adsState = adsState ?? new AdsState()\r\n        this.storeState = storeState ?? new StoreState(this.firstLaunchTime)\r\n        \r\n        this.settings = settings ?? new SettingsState(lang)\r\n        this.statistic = statistic ?? new StatisticState()\r\n        this.appsflyerState = appsflyerState ?? new AppsflyerState()\r\n        this.hardmodeDeadline = hardmodeDeadline ?? new Date(0)\r\n        this.hardSave = hardSave\r\n        this.isRated = isRated ?? false\r\n    }\r\n\r\n    HasGame():boolean\r\n    {\r\n        return this.gameState != null\r\n    }\r\n    IsGameFinished():boolean\r\n    {\r\n        return this.gameState?.isFinished ?? true\r\n    }\r\n    HasHardsave():boolean\r\n    {\r\n        return this.hardSave != undefined\r\n    }\r\n\r\n    Save(): string {\r\n        return JSON.stringify(this)\r\n    }\r\n\r\n    static Load(input:string, lang:string): ApplicationState\r\n    {\r\n        let obj = JSON.parse(input)\r\n        if(!(\"isFirstLaunch\" in obj)) {\r\n            return new ApplicationState(1,lang)\r\n        }\r\n        return new ApplicationState( \r\n            obj.version,\r\n            \"en\",\r\n            GameState.Load(obj.gameState), \r\n            AdsState.Load(obj.adsState),\r\n            StoreState.Load(obj.storeState),\r\n            OfferState.Load(obj.offerState),\r\n            SettingsState.Load(obj.settings),\r\n            StatisticState.Load(obj.statistic),\r\n            AppsflyerState.Load(obj.appsflyerState),\r\n            obj.firstLaunch,            \r\n            new Date(obj.firstLaunchTime),\r\n            new Date(obj.hardmodeDeadline),\r\n            obj.hardSave ? GameState.Load(obj.hardSave) : undefined,\r\n            obj.isRated\r\n        )\r\n    }\r\n}"]}